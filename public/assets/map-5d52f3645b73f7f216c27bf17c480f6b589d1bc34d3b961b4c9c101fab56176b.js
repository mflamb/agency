function outline(){return[new ol.style.Style({stroke:new ol.style.Stroke({color:"#a9a9a9",width:2})})]}function affordstyle(){return[new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#605756",width:.5}),fill:new ol.style.Fill({color:"#f3a4a4"})})})]}function makePattern(){var e=document.createElement("canvas"),o=e.getContext("2d");e.width=6,e.height=6,o.fillStyle="rgb(255, 0, 0)";for(var t=0;t<6;++t)o.fillRect(t,t,1,1);return o.createPattern(e,"repeat")}function commercialStyle(){return[new ol.style.Style({stroke:new ol.style.Stroke({color:"E74C3C",width:.5}),fill:new ol.style.Fill({color:makePattern()})})]}function parkingStyle(){return[new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"white",width:0}),fill:new ol.style.Fill({color:"#37474F"})})})]}var neighborhoods_source=new ol.source.Vector({url:"https://raw.githubusercontent.com/azavea/geo-data/master/Neighborhoods_Philadelphia/Neighborhoods_Philadelphia.geojson",format:new ol.format.GeoJSON}),neighborhoods_layer=new ol.layer.Vector({source:neighborhoods_source,style:outline});console.log("Neighborhoodlayer:",neighborhoods_layer);var affordable_source=new ol.source.Vector({url:"https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+affordablehousingproduction&filename=affordablehousingproduction&format=geojson&skipfields=cartodb_id",format:new ol.format.GeoJSON}),affordable_layer=new ol.layer.Vector({source:affordable_source,style:affordstyle});console.log("affordablehousinglayer:",affordable_layer);var commercial_corridors_source=new ol.source.Vector({url:"https://phl.carto.com/api/v2/sql?q=SELECT+*+FROM+phl.commercial_corridors&filename=phl.commercial_corridors&format=geojson&skipfields=cartodb_id",format:new ol.format.GeoJSON}),commercial_corridors_layer=new ol.layer.Vector({source:commercial_corridors_source,style:commercialStyle});console.log("commercialcorridorlayer:",commercial_corridors_layer);var residential_parking_source=new ol.source.Vector({url:"https://phl.carto.com/api/v2/sql?q=select+*+from+phl.residential_parking_permit_blocks&filename=phl.residential_parking_permit_blocks&format=geojson&skipfields=cartodb_id",format:new ol.format.GeoJSON}),residential_parking_layer=new ol.layer.Vector({source:residential_parking_source,style:parkingStyle});console.log("carparkinglayer:",residential_parking_layer);var baseMap=new ol.layer.Tile({source:new ol.source.XYZ({url:"http://{1-4}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"})}),map=new ol.Map({theme:null,target:"map",layers:[baseMap,neighborhoods_layer,commercial_corridors_layer,affordable_layer,residential_parking_layer],view:new ol.View({center:ol.proj.fromLonLat([-75.163338,39.99155]),zoom:11.5})}),layersinmap=[neighborhoods_layer,commercial_corridors_layer,affordable_layer,residential_parking_layer];document.addEventListener("DOMContentLoaded",()=>{var e=null,o=new ol.interaction.Select({condition:ol.events.condition.click}),t=(new ol.interaction.Select({condition:function(e){return ol.events.condition.click(e)&&ol.events.condition.altKeyOnly(e)}}),document.getElementById("type")),n=function(){null!==e&&map.removeInteraction(e);var n=t.value;null!==(e="click"==n?o:null)&&(map.addInteraction(e),map.on("click",function(){layersinmap.forEach(function(e){e.once("precompose",function(){var e=o.getFeatures();if(e.a[0]!==undefined){var t=e.a[0].N.name,n=e.a[0].N.vac_count,r=e.a[0].N.vac_rate,i=e.a[0].N.mapname,l=e.a[0].N.block,a=e.a[0].N.district_number,c=e.a[0].N.street,d=e.a[0].N.name,s=e.a[0].N.address,m=e.a[0].N.total_unit;i!==undefined?(document.getElementById("Neighborhood_Info").setAttribute("style","display:visible"),document.getElementById("description").innerHTML="<b>Selected Neighborhood</b>",document.getElementById("description").setAttribute("style","display:visible"),document.getElementById("Neighborhood_Info").innerHTML=i,document.getElementById("counsel_info").innerHTML="",document.getElementById("afford_info").innerHTML="",document.getElementById("res_parking_info").innerHTML=""):t!==undefined&&n!==undefined?(document.getElementById("description").innerHTML="<b>Selected Commercial District Description</b>",document.getElementById("description").setAttribute("style","display:visible"),null!==n&&null!==r?(document.getElementById("counsel_info").innerHTML=`${t} <br><br> <b>Commercial Vacancy Count: </b> ${n} <br><br> <b>Commercial Vacancy Rate: </b> ${r}`,document.getElementById("Neighborhood_Info").innerHTML="",document.getElementById("afford_info").innerHTML="",document.getElementById("res_parking_info").innerHTML=""):(document.getElementById("counsel_info").innerHTML=`<b>Name: </b><br>${t} <br><br> No vacancy data available for this district`,document.getElementById("Neighborhood_Info").innerHTML="",document.getElementById("afford_info").innerHTML="",document.getElementById("res_parking_info").innerHTML="")):d!==undefined?(document.getElementById("description").innerHTML="<b>Selected Affordable Housing Description</b>",document.getElementById("description").setAttribute("style","display:visible"),document.getElementById("afford_info").innerHTML=`<b>Organization: </b><br> ${d} ${s} ${m};`,document.getElementById("Neighborhood_Info").innerHTML="",document.getElementById("counsel_info").innerHTML="",document.getElementById("res_parking_info").innerHTML=""):l!==undefined&&(document.getElementById("description").innerHTML="<b>Selected Residential Parking Permit Details</b>",document.getElementById("description").setAttribute("style","display:visible"),document.getElementById("res_parking_info").innerHTML=`<b>Street: </b> ${c} <br>Block: </b>${l} <br><b>District Number: <b>${a}`,document.getElementById("counsel_info").innerHTML="",document.getElementById("afford_info").innerHTML="",document.getElementById("Neighborhood_Info").innerHTML="")}})})}))};t.onchange=n,n()});var highlight,highlightStyleCache={},featureOverlay=new ol.layer.Vector({source:new ol.source.Vector,map:map,style:function(e,o){var t=1e5*o<10?e.get("text"):"";return highlightStyleCache[t]||(highlightStyleCache[t]=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000066",width:2}),fill:new ol.style.Fill({color:"rgba(192,192,192,0.7)"}),text:new ol.style.Text({font:"12px Calibri,sans-serif",text:t,fill:new ol.style.Fill({color:"#000"}),stroke:new ol.style.Stroke({color:"#f00",width:3})})})),highlightStyleCache[t]}}),displayFeatureInfo=function(e){var o=map.forEachFeatureAtPixel(e,function(e){return e}),t=document.getElementById("info");o&&o.get("mapname")?t.innerHTML="<b>Mouseover Neighborhood: </b><br>"+o.get("mapname"):t.innerHTML="&nbsp;",o!==highlight&&(highlight&&featureOverlay.getSource().removeFeature(highlight),o&&featureOverlay.getSource().addFeature(o),highlight=o)};map.on("pointermove",function(e){if(!e.dragging){var o=map.getEventPixel(e.originalEvent);displayFeatureInfo(o)}}),document.addEventListener("DOMContentLoaded",()=>{document.getElementById("checkbox_Nej").addEventListener("click",function(){var e=this.checked;e!==neighborhoods_layer.getVisible()&&neighborhoods_layer.setVisible(e)}),neighborhoods_layer.on("click:visible",function(){var o=this.getVisible();o!==e.checked&&(e.checked=o)});var e=document.getElementById("checkbox");e.addEventListener("click",function(){var e=this.checked;e!==affordable_layer.getVisible()&&affordable_layer.setVisible(e)}),affordable_layer.on("click:visible",function(){var o=this.getVisible();o!==e.checked&&(e.checked=o)}),document.getElementById("checkbox_counsel").addEventListener("click",function(){var e=this.checked;e!==commercial_corridors_layer.getVisible()&&commercial_corridors_layer.setVisible(e)}),commercial_corridors_layer.on("click:visible",function(){var o=this.getVisible();o!==e.checked&&(e.checked=o)}),document.getElementById("checkbox_parks").addEventListener("click",function(){var e=this.checked;e!==residential_parking_layer.getVisible()&&residential_parking_layer.setVisible(e)}),residential_parking_layer.on("click:visible",function(){var o=this.getVisible();o!==e.checked&&(e.checked=o)})});